document.addEventListener("DOMContentLoaded",()=>{const urlParams=new URLSearchParams(window.location.search);const carId=urlParams.get("id");const car=carsData.cars.find(c=>c.id===carId);if(!car){console.error("Auto no encontrado:",carId);window.location.href="index.html";return}document.getElementById("pageTitle").textContent=`${car.name} - The Crew Motorfest`;actualizarMetaTags(car);const brandLogo=document.getElementById("brandLogo");brandLogo.src=car.brand.logo;brandLogo.alt=car.brand.name;document.getElementById("carName").textContent=car.name;document.getElementById("carInfo").textContent=`${car.brand.name} • ${car.year} • ${car.category}`;const carImage=document.getElementById("carImage");carImage.src=car.image;carImage.alt=car.name;carImage.style.viewTransitionName=`car-image-${car.id}`;document.getElementById("carDescription").textContent=car.description;renderTuningControls(car.tuning);configureBackButton()});function actualizarMetaTags(car){document.querySelector('meta[property="og:title"]').setAttribute("content",car.name);document.querySelector('meta[property="og:description"]').setAttribute("content",car.description);document.querySelector('meta[property="og:image"]').setAttribute("content",car.image);document.querySelector('meta[property="og:url"]').setAttribute("content",window.location.href)}function renderTuningControls(tuning){const tuningControls=document.getElementById("tuningControls");const template=document.getElementById("tuningSliderTemplate");tuningControls.innerHTML="";Object.entries(tuning).forEach(([groupKey,group])=>{const groupElement=document.createElement("div");groupElement.className="tuning-group";const title=document.createElement("h2");title.className="group-title";title.textContent=group.title;groupElement.appendChild(title);Object.entries(group.settings).forEach(([settingKey,setting])=>{const sliderElement=createTuningSlider(template,setting);groupElement.appendChild(sliderElement)});tuningControls.appendChild(groupElement)})}function createTuningSlider(template,setting){const clone=template.content.cloneNode(true);const container=clone.querySelector(".slider-container");if(setting.highlighted){container.classList.add("highlighted")}clone.querySelector(".slider-label").textContent=setting.label;const slider=clone.querySelector(".slider");if(setting.isAlignment){const intValue=Math.round(setting.value*100);const intMin=Math.round(setting.min*100);const intMax=Math.round(setting.max*100);slider.min=intMin;slider.max=intMax;slider.value=intValue;let displayValue;if(setting.value<0){displayValue=`-0.${Math.abs(intValue).toString().padStart(2,"0")}°`}else{displayValue=`0.${intValue.toString().padStart(2,"0")}°`}clone.querySelector(".slider-value").textContent=displayValue;updateSliderPosition(slider,intMin,intMax,intValue)}else{slider.min=setting.min;slider.max=setting.max;slider.value=setting.value;if(setting.dualValues){const[frontValue,rearValue]=setting.value;clone.querySelector(".slider-value-front").textContent=`${frontValue}% - `;clone.querySelector(".slider-value-rear").textContent=`${rearValue}%`;updateDualSliderPosition(slider,setting.min,setting.max,frontValue,rearValue)}else{const displayValue=`${setting.value}%`;clone.querySelector(".slider-value").textContent=displayValue;updateSliderPosition(slider,setting.min,setting.max,setting.value)}}slider.disabled=true;clone.querySelector(".left-label").textContent=setting.leftLabel;clone.querySelector(".right-label").textContent=setting.rightLabel;return clone}function configureBackButton(){const savedCategory=localStorage.getItem("currentCategory")||"";const backButton=document.querySelector(".back-button");backButton.href=`index.html?category=${encodeURIComponent(savedCategory)}`;backButton.addEventListener("click",e=>{if(document.startViewTransition){e.preventDefault();document.startViewTransition(()=>{window.location.href=backButton.href})}})}function updateSliderPosition(slider,min,max,value){const percentage=(value-min)/(max-min)*100;slider.style.backgroundSize=`${percentage}% 100%`}function updateDualSliderPosition(slider,min,max,frontValue,rearValue){const frontPercentage=(frontValue-min)/(max-min)*100;const rearPercentage=(rearValue-min)/(max-min)*100;slider.style.background=`linear-gradient(to right, #f7d538 ${frontPercentage}%, #fae27f ${rearPercentage}%, #ccc ${rearPercentage}%)`}